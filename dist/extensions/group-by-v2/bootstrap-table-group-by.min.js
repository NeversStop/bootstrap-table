/**
  * bootstrap-table - An extended Bootstrap table with radio, checkbox, sort, pagination, and other added features. (supports twitter bootstrap v2 and v3).
  *
  * @version v1.13.0
  * @homepage http://bootstrap-table.wenzhixin.net.cn
  * @author wenzhixin <wenzhixin2010@gmail.com> (http://wenzhixin.net.cn/)
  * @license MIT
  */

(function(a,b){if('function'==typeof define&&define.amd)define(['jquery'],b);else if('undefined'!=typeof exports)b(require('jquery'));else{b(a.jquery),a.bootstrapTableGroupBy={exports:{}}.exports}})(this,function(a){'use strict';var b,c,d=function(a){return a&&a.__esModule?a:{default:a}}(a),e=function(a){var b=arguments,c=!0,d=1;return a=a.replace(/%s/g,function(){var a=b[d++];return'undefined'==typeof a?(c=!1,''):a}),c?a:''},f=function(a,b){var c={};return a.forEach(function(a){var d=b(a);c[d]=c[d]||[],c[d].push(a)}),c};d.default.extend(d.default.fn.bootstrapTable.defaults,{groupBy:!1,groupByField:''});var g=d.default.fn.bootstrapTable.Constructor,h=g.prototype.initSort,i=g.prototype.initBody,j=g.prototype.updateSelected;g.prototype.initSort=function(){h.apply(this,Array.prototype.slice.apply(arguments));var e=this;if(c=[],this.options.groupBy&&''!==this.options.groupByField){this.options.sortName!=this.options.groupByField&&this.data.sort(function(c,a){return c[e.options.groupByField].localeCompare(a[e.options.groupByField])});var e=this,a=f(e.data,function(a){return[a[e.options.groupByField]]}),b=0;d.default.each(a,function(a,d){c.push({id:b,name:a}),d.forEach(function(a){a._data||(a._data={}),a._data['parent-index']=b}),b++})}},g.prototype.initBody=function(){if(b=!0,i.apply(this,Array.prototype.slice.apply(arguments)),this.options.groupBy&&''!==this.options.groupByField){var a=this,f=!1,g=0;this.columns.forEach(function(a){a.checkbox?f=!0:a.visible&&(g+=1)}),this.options.detailView&&!this.options.cardView&&(g+=1),c.forEach(function(b){var c=[];c.push(e('<tr class="info groupBy expanded" data-group-index="%s">',b.id)),a.options.detailView&&!a.options.cardView&&c.push('<td class="detail"></td>'),f&&c.push('<td class="bs-checkbox">','<input name="btSelectGroup" type="checkbox" />','</td>'),c.push('<td',e(' colspan="%s"',g),'>',b.name,'</td>'),c.push('</tr>'),a.$body.find('tr[data-parent-index='+b.id+']:first').before((0,d.default)(c.join('')))}),this.$selectGroup=[],this.$body.find('[name="btSelectGroup"]').each(function(){var b=(0,d.default)(this);a.$selectGroup.push({group:b,item:a.$selectItem.filter(function(){return(0,d.default)(this).closest('tr').data('parent-index')===b.closest('tr').data('group-index')})})}),this.$container.off('click','.groupBy').on('click','.groupBy',function(){(0,d.default)(this).toggleClass('expanded'),a.$body.find('tr[data-parent-index='+(0,d.default)(this).closest('tr').data('group-index')+']').toggleClass('hidden')}),this.$container.off('click','[name="btSelectGroup"]').on('click','[name="btSelectGroup"]',function(b){b.stopImmediatePropagation();var c=(0,d.default)(this),e=c.prop('checked');a[e?'checkGroup':'uncheckGroup']((0,d.default)(this).closest('tr').data('group-index'))})}b=!1,this.updateSelected()},g.prototype.updateSelected=function(){b||(j.apply(this,Array.prototype.slice.apply(arguments)),this.options.groupBy&&''!==this.options.groupByField&&this.$selectGroup.forEach(function(a){var b=a.item.filter(':enabled').length===a.item.filter(':enabled').filter(':checked').length;a.group.prop('checked',b)}))},g.prototype.getGroupSelections=function(a){var b=this;return d.default.grep(this.data,function(c){return c[b.header.stateField]&&c._data['parent-index']===a})},g.prototype.checkGroup=function(a){this.checkGroup_(a,!0)},g.prototype.uncheckGroup=function(a){this.checkGroup_(a,!1)},g.prototype.checkGroup_=function(a,b){var c;b||(c=this.getGroupSelections(a)),this.$selectItem.filter(function filter(){return(0,d.default)(this).closest('tr').data('parent-index')===a}).prop('checked',b),this.updateRows(),this.updateSelected(),b&&(c=this.getGroupSelections(a)),this.trigger(b?'check-all':'uncheck-all',c)}});