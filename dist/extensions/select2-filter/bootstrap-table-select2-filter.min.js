/**
  * bootstrap-table - An extended Bootstrap table with radio, checkbox, sort, pagination, and other added features. (supports twitter bootstrap v2 and v3).
  *
  * @version v1.13.0
  * @homepage http://bootstrap-table.wenzhixin.net.cn
  * @author wenzhixin <wenzhixin2010@gmail.com> (http://wenzhixin.net.cn/)
  * @license MIT
  */

(function(a,b){if('function'==typeof define&&define.amd)define(['jquery'],b);else if('undefined'!=typeof exports)b(require('jquery'));else{b(a.jquery),a.bootstrapTableSelect2Filter={exports:{}}.exports}})(this,function(a){'use strict';function b(a){var b=a.$header;return a.options.height&&(b=a.$tableHeader),b}function c(a){if(!f.default.isEmptyObject(a.filterColumnsPartial)){var c=b(a);f.default.each(a.columns,function(b,d){var e=a.filterColumnsPartial[d.field];if(d.filter)if(d.filter.setFilterValue){var f=c.find('[data-field='+d.field+'] .filter');d.filter.setFilterValue(f,d.field,e)}else{var g=c.find('[data-filter-field='+d.field+']');switch(d.filter.type){case'input':g.val(e);case'select':g.val(e).trigger('change');}}})}}function d(a,b){var c,d,e=!1,g=0;f.default.each(a.columns,function(h,j){if(c='hidden',d=null,!!j.visible){if(!j.filter)d=(0,f.default)('<div class="no-filter"></div>');else{var i=j.filter.class?' '+j.filter.class:'';if(d=(0,f.default)('<div style="margin: 0px 2px 2px 2px;" class="filter'+i+'">'),j.searchable&&(e=!0,c='visible'),j.filter.template)d.append(j.filter.template(a,j,c));else{var k=(0,f.default)(a.options.filterTemplate[j.filter.type.toLowerCase()](a,j,c));switch(j.filter.type){case'input':var l=!0;k.off('compositionstart').on('compositionstart',function(){l=!1}),k.off('compositionend').on('compositionend',function(b){l=!0;var c=(0,f.default)(this);clearTimeout(g),g=setTimeout(function(){a.onColumnSearch(b,j.field,c.val())},a.options.searchTimeOut)}),k.off('keyup').on('keyup',function(b){if(l){var c=(0,f.default)(this);clearTimeout(g),g=setTimeout(function(){a.onColumnSearch(b,j.field,c.val())},a.options.searchTimeOut)}}),k.off('mouseup').on('mouseup',function(b){var c=(0,f.default)(this),d=c.val();''===d||setTimeout(function(){var d=c.val();''===d&&(clearTimeout(g),g=setTimeout(function(){a.onColumnSearch(b,j.field,d)},a.options.searchTimeOut))},1)});break;case'select':k.on('select2:select',function(b){a.onColumnSearch(b,j.field,(0,f.default)(this).val())}),k.on('select2:unselecting',function(b){var c=(0,f.default)(this);b.preventDefault(),c.val(null).trigger('change'),a.searchText=void 0,a.onColumnSearch(b,j.field,c.val())});}d.append(k)}}f.default.each(b.children().children(),function(a,b){if(b=(0,f.default)(b),b.data('field')===j.field)return b.find('.fht-cell').append(d),!1})}}),e||b.find('.filter').hide()}function e(a){var c=b(a);f.default.each(a.columns,function(b,d){if(d.filter&&'select'===d.filter.type){var e=c.find('select[data-filter-field="'+d.field+'"]');if(0<e.length&&!e.data().select2){var f={placeholder:'',allowClear:!0,data:d.filter.data,dropdownParent:a.$el.closest('.bootstrap-table')};e.select2(f)}}})}var f=function(a){return a&&a.__esModule?a:{default:a}}(a);f.default.extend(f.default.fn.bootstrapTable.defaults,{filter:!1,filterValues:{},filterTemplate:{input:function(a,b,c){return'<input type="text" class="form-control" data-filter-field="'+b.field+'" style="width: 100%; visibility:'+c+'">'},select:function(a,b,c){return'<select data-filter-field="'+b.field+'" style="width: 100%; visibility:'+c+'"></select>'}},onColumnSearch:function(){return!1}}),f.default.extend(f.default.fn.bootstrapTable.COLUMN_DEFAULTS,{filter:void 0}),f.default.extend(f.default.fn.bootstrapTable.Constructor.EVENTS,{"column-search.bs.table":'onColumnSearch'});var g=f.default.fn.bootstrapTable.Constructor,h=g.prototype.init,i=g.prototype.initHeader,j=g.prototype.initSearch;g.prototype.init=function(){if(this.options.filter){var a=this;a.options.filterTemplate&&(a.options.filterTemplate=f.default.extend({},f.default.fn.bootstrapTable.defaults.filterTemplate,a.options.filterTemplate)),f.default.isEmptyObject(a.options.filterValues)||(a.filterColumnsPartial=a.options.filterValues,a.options.filterValues={}),this.$el.on('reset-view.bs.table',function(){!a.options.height||0<a.$tableHeader.find('select').length||0<a.$tableHeader.find('input').length||d(a,a.$tableHeader)}).on('post-header.bs.table',function(){var b=0;e(a),clearTimeout(b),b=setTimeout(function(){c(a)},a.options.searchTimeOut-1e3)}).on('column-switch.bs.table',function(){c(a)})}h.apply(this,Array.prototype.slice.apply(arguments))},g.prototype.initHeader=function(){i.apply(this,Array.prototype.slice.apply(arguments)),this.options.filter&&d(this,this.$header)},g.prototype.initSearch=function(){var a=this,b=a.filterColumnsPartial;'client'===a.options.sidePagination&&(this.data=f.default.grep(this.data,function(c,d){for(var e in b){var g=a.columns[a.fieldsColumnsIndex[e]],h=b[e].toLowerCase(),i=c[e];if(i=f.default.fn.bootstrapTable.utils.calculateObjectValue(a.header,a.header.formatters[f.default.inArray(e,a.header.fields)],[i,c,d],i),g.filterStrictSearch){if(-1===f.default.inArray(e,a.header.fields)||'string'!=typeof i&&'number'!=typeof i||i.toString().toLowerCase()!==h.toString().toLowerCase())return!1;}else if(-1===f.default.inArray(e,a.header.fields)||'string'!=typeof i&&'number'!=typeof i||-1===(i+'').toLowerCase().indexOf(h))return!1}return!0})),j.apply(this,Array.prototype.slice.apply(arguments))},g.prototype.onColumnSearch=function(a,b,c){f.default.isEmptyObject(this.filterColumnsPartial)&&(this.filterColumnsPartial={}),c?this.filterColumnsPartial[b]=c:delete this.filterColumnsPartial[b],this.options.pageNumber=1,this.onSearch(a),this.trigger('column-search',b,c)},g.prototype.setSelect2Data=function(a,c){var d=this,e=b(d),g=e.find('select[data-filter-field="'+a+'"]');g.empty(),g.select2({data:c,placeholder:'',allowClear:!0,dropdownParent:d.$el.closest('.bootstrap-table')}),f.default.each(this.columns,function(b,d){if(d.field===a)return d.filter.data=c,!1})},g.prototype.setFilterValues=function(a){this.filterColumnsPartial=a},f.default.fn.bootstrapTable.methods.push('setSelect2Data'),f.default.fn.bootstrapTable.methods.push('setFilterValues')});